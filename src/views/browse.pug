extend layouts/base.layout.pug

include partials/top-bar.pug
include partials/page-title.pug
include partials/icon.pug
include partials/product-card-simple.pug
include partials/post.pug
include partials/poll.pug
include partials/login-modal.pug
include partials/comment.pug

mixin browse-posts-list-loading()
  div(class="w-full bg-white rounded-md border border-gray-200 animate-pulse mb-4")
    div(class="w-full h-full relative p-4")
      div(class="w-14 h-14 bg-gray-200 rounded-full")
      div(class="my-4")
        div(class="h-2 mb-2 w-full bg-gray-200")
        div(class="h-2 mb-2 w-full bg-gray-200")
        div(class="h-2 w-full bg-gray-200")

  div(class="w-full bg-white rounded-md border border-gray-200 animate-pulse mb-4")
    div(class="w-full h-full relative p-4")
      div(class="w-14 h-14 bg-gray-200 rounded-full")
      div(class="my-4")
        div(class="h-2 mb-2 w-full bg-gray-200")
        div(class="h-2 mb-2 w-full bg-gray-200")
        div(class="h-2 w-full bg-gray-200")

  div(class="w-full bg-white rounded-md border border-gray-200 animate-pulse mb-4")
    div(class="w-full h-full relative p-4")
      div(class="w-14 h-14 bg-gray-200 rounded-full")
      div(class="my-4")
        div(class="h-2 mb-2 w-full bg-gray-200")
        div(class="h-2 mb-2 w-full bg-gray-200")
        div(class="h-2 w-full bg-gray-200")

  div(class="w-full bg-white rounded-md border border-gray-200 animate-pulse mb-4")
    div(class="w-full h-full relative p-4")
      div(class="w-14 h-14 bg-gray-200 rounded-full")
      div(class="my-4")
        div(class="h-2 mb-2 w-full bg-gray-200")
        div(class="h-2 mb-2 w-full bg-gray-200")
        div(class="h-2 w-full bg-gray-200")

  div(class="w-full bg-white rounded-md border border-gray-200 animate-pulse mb-4")
    div(class="w-full h-full relative p-4")
      div(class="w-14 h-14 bg-gray-200 rounded-full")
      div(class="my-4")
        div(class="h-2 mb-2 w-full bg-gray-200")
        div(class="h-2 mb-2 w-full bg-gray-200")
        div(class="h-2 w-full bg-gray-200")

  div(class="w-full bg-white rounded-md border border-gray-200 animate-pulse mb-4")
    div(class="w-full h-full relative p-4")
      div(class="w-14 h-14 bg-gray-200 rounded-full")
      div(class="my-4")
        div(class="h-2 mb-2 w-full bg-gray-200")
        div(class="h-2 mb-2 w-full bg-gray-200")
        div(class="h-2 w-full bg-gray-200")

block append head
  meta(name="turbo-cache-control" content="no-cache")

block append templates
  template(data-comment-tpl)
    +comment({
      img: '',
      type: USER_TYPES.CREATOR_LITE,
      slug: '',
      twitter_name: '',
      twitter_screen_name: '',
      created_at: '',
      content: ''
    })

block content
  div(class="absolute top-0 left-0 w-full h-1/4 gradient-bg")
  div(class="relative")
    +top-bar("browse")
    div(class="container p-4 mx-auto")
      div(class="flex flex-col-reverse md:flex-row items-start")
        main(class="mr-0 w-full md:w-4/6 md:mr-4")
          +page-title(class="mb-4") Latest posts
          
          turbo-frame(id="browse-posts-list" src="/browse/posts" target="_top")
            +browse-posts-list-loading


          p(class="text-gray-500 text-center text-sm") Post listing is limited to 18 items only.

        aside(class="md:w-2/6 mb-16 md:mb-0 w-full")
          div(class="mb-4")
            +page-title(class="mb-4") Top products
            each product, idx in mostBoostedProducts
              div(class="pb-2")
                +product-card-simple({
                  place: idx < 3 ? idx : null,
                  slug: product.slug,
                  name: product.name,
                  boosts_count: product.boosts_count,
                  description: product.description
                })
            div(class="mt-3")
              a(href="/products?ord=boosts" class="flex justify-center items-center btn btn-default transition click-scale")
                span(class="mr-2") View most boosted
                +icon("arrow-right", { width: 16, height: 16 })

          div
            +page-title(class="mb-4") Latest products
            each product, idx in newestProducts
              div(class="pb-2")
                +product-card-simple({
                  slug: product.slug,
                  name: product.name,
                  boosts_count: product.boosts_count,
                  description: product.description
                })
            div(class="mt-3")
              a(href="/products?ord=newest" class="flex justify-center items-center btn btn-default transition click-scale")
                span(class="mr-2") View latest
                +icon("arrow-right", { width: 16, height: 16 })

block modals
  if !user
    +login-modal