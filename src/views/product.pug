extends layouts/base.layout.pug

include partials/top-bar.pug
include partials/post.pug
include partials/icon.pug

block content
  +top-bar
  div(class="container mx-auto p-4")
    if !product.is_public
      span(class="flex text-xs flex items-center pb-2")
        span(class="mr-2")
          +icon("lock")
        span(class="border-b-4 border-purple-400") Private
    div(class="flex items-center justify-between" data-product-slug=product.slug data-product-boosts-count=boosts.length)
      div(class="flex items-center")
        h1(class="text-2xl font-bold inline-block mr-4")= product.name
        if product.website
          a(href=product.website class="icon-container" target="_blank" rel="noreferrer noopener" title=product.website)
            +icon("globe")
      div(class="relative flex items-center")
        span(class="text-xs text-gray-500 uppercase mr-2 bg-gray-100 dark:bg-gray-700 rounded-xl px-2 py-1") Creator
        img(src=product.user_twitter_profile_image_url alt=`Photo of the creator of ${product.name}` class="cursor-pointer w-12 h-12 rounded-full border-2 border-yellow-300 hover:border-yellow-400" data-ctx-menu-trigger="creator-mini-profile")
        div(class="hidden z-20 absolute top-14 right-0 p-4 bg-white border boder-gray-100 dark:bg-gray-800 dark:border-gray-700 rounded-xl shadow-xl" style="width: 300px;" data-ctx-menu="creator-mini-profile")
          div(class="icon-container absolute top-4 right-4 cursor-pointer text-2xl" data-ctx-menu-close)
            +icon("x")
          h2(class="text-lg font-bold")= product.user_twitter_name
          a(href=`https://twitter.com/@${product.user_twitter_screen_name}` class="inline-block text-sm text-gray-500 mb-4 font-medium block" target="_blank" rel="noreferrer noopener" title="Open twitter profile in a new window")= `@${product.user_twitter_screen_name}`
          p(class="text-gray-600 dark:text-gray-400")= product.user_bio

    div(class={"my-8": true, "product-header": true})
      if product.description
        p(class="text-xl")= product.description
      else
        p(class="text-gray-500") No product description, yet
      nav(id="product-nav")
        ul
          li(class="w-full mb-2")
            div(title=`Boost ${product.name} to show it's creator that you care about it. This also helps the product get better haptic rank.` class="select-none cursor-pointer block px-4 py-2 rounded-xl border border-gray-300 hover:border-transparent dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700" data-product-boost-btn)
              span(class="flex justify-between")
                span(class="flex items-center")
                  span(class="mr-4")
                    +icon("chevrons-up")
                  span(class="mr-4")= `Boost`
                span(class="px-4 py-1 bg-yellow-300 font-medium text-gray-800 rounded-full text-xs uppercase" data-product-boost-counter)= boosts.length

    hr(class="border-gray-300 dark:border-gray-700 mb-8")

    main(id="product-main")
      section(id="product-feed")
        if posts.length
          each post in posts
            - var post_text = post.text;
            +post({
              product_slug: product.slug,
              product_name: product.name,
              post_id: post.id,
              img: post.user_twitter_profile_image_url,
              img_url: post.image_url,
              twitter_name: post.user_twitter_name,
              twitter_screen_name: post.user_twitter_screen_name,
              date_str: post.created_at_formatted,
              show_opts: false,
              boosts_count: post.boosts_count
            }) !{post_text}
        else
          div(class="flex items-center text-gray-500")
            span(class="mr-2 p-2 w-12 h-12 flex items-center justify-center bg-gray-50 rounded-full")
              +icon("activity", { width: '32', height: '32', stroke: "muted" })
            p(class="text-xl") Still no public updates available

block append scripts
  script(src="/static/js/product.js")
